<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Innes Rail - automating a model railway"><meta name=author content="Cloud-Native Toolkit development team"><link href=https://innesrail.github.io/innesRail/raspiSetup/ rel=canonical><link rel=icon href=../images/cloudnativetoolkit.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-7.0.6"><title>Raspberry Pi setup - Innes Rail</title><link rel=stylesheet href=../assets/stylesheets/main.2c0c5eaf.min.css><link rel=stylesheet href=../assets/stylesheets/palette.7fa14f5b.min.css><meta name=theme-color content=#2094f3><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Pangolin:300,400,400i,700%7CSource+Code+Pro&display=fallback"><style>:root{--md-text-font-family:"Pangolin";--md-code-font-family:"Source Code Pro"}</style><link rel=stylesheet href=../css/extra.css><link rel=stylesheet href=../css/toolkit-code.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#raspberry-pi-setup class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Innes Rail" class="md-header__button md-logo" aria-label="Innes Rail" data-md-component=logo> <img src=../images/cloudnativetoolkit.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Innes Rail </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Raspberry Pi setup </span> </div> </div> </div> <div class=md-header__options> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/innesrail/innesRail/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> innesRail </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Innes Rail" class="md-nav__button md-logo" aria-label="Innes Rail" data-md-component=logo> <img src=../images/cloudnativetoolkit.png alt=logo> </a> Innes Rail </label> <div class=md-nav__source> <a href=https://github.com/innesrail/innesRail/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> innesRail </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../home/ class=md-nav__link> Home </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> Prerequisites </a> <nav class=md-nav aria-label=Prerequisites> <ul class=md-nav__list> <li class=md-nav__item> <a href=#additional-setup-for-windows-users class=md-nav__link> Additional setup for Windows users </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setup class=md-nav__link> Setup </a> </li> <li class=md-nav__item> <a href=#setup-dcc class=md-nav__link> Setup DCC++ </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/innesrail/innesRail/edit/master/docs/raspiSetup.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=raspberry-pi-setup>Raspberry Pi setup<a class=headerlink href=#raspberry-pi-setup title="Permanent link">&para;</a></h1> <p>A raspberry Pi will host JMRI and also the Arduino environment to program the arduino for DCC++.</p> <h2 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h2> <p>You need:</p> <ul> <li>a Raspberry Pi</li> <li>I am using a Raspberry Pi 4 Model B with 4 GB of memory, but you should be able to use a Raspberry Pi 3 Model B with 1GB memory or the Pi 4 with 1 or 2 GB memory.</li> <li>microSD card of at least 16GB</li> <li>Raspberry Pi power supply</li> <li>optionally a case for the Raspberry Pi - a Raspberry Pi 4 can run quite warm, so a heat sync case or a case that allows good airflow is recommended</li> <li>On your computer you need to install an application to be able to remotely control the Raspberry Pi and see the Raspbery Pi desktop. The best option is to install is <a href=https://www.realvnc.com/en/connect/download/viewer/ >RealVNC viewer</a></li> </ul> <h3 id=additional-setup-for-windows-users>Additional setup for Windows users<a class=headerlink href=#additional-setup-for-windows-users title="Permanent link">&para;</a></h3> <p>Windows users will need the following software installed to be able to work with the Raspberry Pi:</p> <ul> <li><a href="https://support.apple.com/kb/dl999?locale=en_GB">Bonjour Print Services</a></li> <li><a href=https://putty.org>putty</a></li> </ul> <h2 id=setup>Setup<a class=headerlink href=#setup title="Permanent link">&para;</a></h2> <ul> <li>Download the latest <a href=https://www.raspberrypi.org/downloads/raspbian/ >raspbian image</a>. I used the desktop version, but without the recommended software installed.</li> <li>unarchive the image</li> <li>flash the image to a micro SD card. There is a recommended application on the Raspberry Pi site, but I use <a href=https://www.balena.io/etcher/ >belana etcher</a></li> <li>Once the image is flashed the SD card will be ejected from your system. You need to reinsert it and create an empty file called ssh in the boot partition. To do this open a command line window then cd into the boot partition directory on the sd card and enter the following command:</li> <li><code>touch ssh</code> on mac and linux</li> <li><code>type NUL &gt;&gt; ssh</code> on windows using command prompt </li> <li><code>echo $null &gt;&gt; ssh</code> on windows using PowerShell</li> <li> <p>Optionally, if you need to use WiFi rather than an ethernet connection create a file called <strong>wpa_supplicant.conf</strong> and ensure it has the following content (<em>modify the 2 letter country code, NETWORK_NAME and NETWORK_PASSWORD to match your location and WiFi you want to connect to</em>) <div class=highlight><pre><span></span><code>ctrl_interface=DIR=/var/run/wpa_supplicant
GROUP=netdev
update_config=1
country=GB

network={
  ssid=&quot;NETWORK_NAME&quot;
  psk=&quot;NETOWRK_PASSWORD&quot;
}
</code></pre></div></p> </li> <li> <p>Eject the microSD card from your computer and insert it into the Raspberry Pi</p> </li> <li>Connect the Ethernet cable if needed and the power supply to the raspberry pi to power up the raspberry pi. On initial boot the raspberry pi will appear on the network using hostname raspberrypi.local. </li> </ul> <p><code>&lt;TODO - add basic setup, initial loginm raspi config and update here&gt;</code></p> <ul> <li>Add additional software using the command <code>sudo apt install -y netatalk</code></li> <li>Download the JMRI software using command <code>wget https://github.com/JMRI/JMRI/releases/download/v4.18/JMRI.4.18+R37ad3d0.tgz</code></li> <li>uncompress the downloaded file with command <code>tar zxvf JMRI.4.18+R37ad3d0.tgz</code></li> <li>Move JMRI to the /opt directory and tidy up temporary files with command <code>cd /opt &amp;&amp; sudo cp -R ~/JMRI JMRI &amp;&amp; rm -rf ~/JMRI &amp;&amp; rm ~/JMRI.4.18+R37ad3d0.tgz</code></li> </ul> <h2 id=setup-dcc>Setup DCC++<a class=headerlink href=#setup-dcc title="Permanent link">&para;</a></h2> <ul> <li>Open a browser and navigate to <code>https://www.arduino.cc/en/Main/Software</code>. Download the Arduino IDE for <strong>Linux ARM 32 bits</strong>*</li> <li>expand the downloaded file with comand <code>cd Downloads &amp;&amp; tar zxvf arduino-1.8.12-linuxarm.tar.xz</code></li> <li>install arduino using command <code>cd arduino-1.8.12 &amp;&amp; sudo ./install.sh</code></li> <li>download DCC++ code using command <code>cd ~ &amp;&amp; git clone https://github.com/DccPlusPlus/BaseStation.git</code></li> <li>connect the arduino to the Raspberry Pi using a USB cable</li> <li>launch the Arduino IDE using a desktop connection over VNC. The application should be in the system menu under programming</li> <li>open the DCC++ application using <strong>File</strong>-&gt;<strong>Open</strong> then navigate to the <strong>pi/BaseStation/DCCpp_Uno</strong> directory and open file <strong>DCCpp_Uno.ino</strong></li> <li>set the correct board type, using menu <strong>Tools</strong>-&gt;<strong>Board</strong> and select <strong>Arduino Uno</strong> or <strong>Arduino Mega or Mega 2560</strong>, choosing the appropriate value for your Arduino board</li> <li>set the connection port, using menu <strong>Tools</strong>-&gt;<strong>Board</strong> and select <strong>/dev/ttyACM0</strong> or the port that indicates it has your board attached</li> <li>verify the processor is set correctly in menu <strong>Tools</strong>-&gt;<strong>Processor</strong> (if using a Mega you can choose the original Mega or Mega 2560)</li> <li>press the upload button (arrow to right), which will compile and then upload the program to your Arduino board</li> </ul> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright © 2021 innesRail </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tracking"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script> <script src=../assets/javascripts/bundle.a1c7c35e.min.js></script> </body> </html>